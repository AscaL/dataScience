---
title: "Final Project: House Prices: Advanced Regression Techniques"
output: html_notebook
---

Project found on the [Kaggle Site](https://www.kaggle.com/c/house-prices-advanced-regression-techniques).

Loading Libs
```{r}
library(tidyverse)
library(ggplot2)
library(ggthemes)
```


Loading the data
```{r}
test <- read.csv("~/dataScience/final/test.csv")
train <- read.csv("~/dataScience/final/train.csv")
sampleSub <- read.csv("~/dataScience/final/sample_submission.csv")
summary(train)
head(train)
```

First plot: SquareFeet vs Sale Price
```{r}
ggplot(train, aes(y = SalePrice, x = GrLivArea)) + geom_point()
ggplot(train, aes(GrLivArea)) +
  geom_histogram(fill = 'light green', color = 'black') +
  theme_dark()
```

We can see that there are four outliers, let's remove them:
```{r}
train <- train[-which(train$GrLivArea > 4000)]
# Why am i doing this?
ggplot(train, aes(TotalBsmtSF)) + #total sqr feet of the basement
  geom_histogram(fill = 'light green', color = 'black') +
  theme_dark()
```

```{r}
train <- train %>%
  select_if(is.numeric)
```

```{r}
library(reshape2)
train %>%
  cor() %>%
  melt() %>%
  ggplot() +
  geom_tile(aes(x = Var1, y = Var2, fill = value))
```

Remove missing values
```{r}
colSums(is.na(train))
train_mean <- colMeans(train, na.rm = T)
train <- replace_na(train, replace = as.list(train_mean))
colSums(is.na(train))

# Plot GrLivArea vs SalePrice
ggplot(train) +  geom_point(aes(y = SalePrice, x = GrLivArea))
# Remove outliers
train <- train[-which(train$GrLivArea > 4000),]
ggplot(train) +  geom_point(aes(y = SalePrice, x = GrLivArea))
# reg
#train$SalePrice <- log(train$SalePrice)
reg <- lm(SalePrice ~ GrLivArea, data = train)
summary(reg)
test$SalePrice <- predict(reg, newdata = test)
test %>%
  select(Id, SalePrice) %>%
  write.csv(file = "prediction.csv", row.names = F)
```
